databaseChangeLog:
  # Add new view
  - changeSet:  
      id:  createView-campaign  
      author:  R1304520  
      changes:  
        - createView:  
            encoding:  UTF-8 
            replaceIfExists:  true 
            selectQuery: SELECT DISTINCT s.SOCIETE_SID, s.CODE_SIF, s.CODE_AMUNDI, s.SOCIETE_LIBELLE, s.FLAG_ADHERENTE, s.FLAG_ACTIF, a.ANNEE_ID, a.FLAG_EN_COURS, f.FORMULAIRE_ID, f.FORMULAIRE_LIBELLE, cpg.FLAG_CHANGEMENT, st.STATUT_ID, st.STATUT_LIBELLE, cpgu.DATE_DERNIER_MAIL, cpgu.FLAG_ENVOIE_MAIL, cpgu.FLAG_RELANCE_MAIL, ps.UTILISATEUR_ID CORRESPONDANTN_ID, cu.SGID CORRESPONDANTN_SGID, cu.NOM CORRESPONDANTN_NOM, cu.PRENOM CORRESPONDANTN_PRENOM, cu.EMAIL CORRESPONDANTN_EMAIL, cu.TELEPHONE CORRESPONDANTN_TELEPHONE, ( SELECT ps2.UTILISATEUR_ID AS UTILISATEUR_PRECEDENT_ID FROM PE_PAR_SUIVI_SOCIETES cpg2 LEFT JOIN PE_PAR_SOCIETE ps2 on ps2.ANNEE_ID = cpg2.ANNEE_ID and ps2.SOCIETE_SID = cpg2.SOCIETE_SID WHERE cpg2.SOCIETE_SID = cpg.SOCIETE_SID AND cpg2.ANNEE_ID = cpg.ANNEE_ID - 1 AND cpg2.FORMULAIRE_ID = cpg.FORMULAIRE_ID ) as CORRESPONDANTN1_ID, ( SELECT pu.SGID FROM PE_PAR_SUIVI_SOCIETES cpg2 LEFT JOIN PE_PAR_SOCIETE ps2 on ps2.ANNEE_ID = cpg2.ANNEE_ID and ps2.SOCIETE_SID = cpg2.SOCIETE_SID LEFT JOIN PE_DIM_UTILISATEURS pu on pu.UTILISATEUR_ID = ps2.UTILISATEUR_ID WHERE cpg2.SOCIETE_SID = cpg.SOCIETE_SID AND cpg2.ANNEE_ID = cpg.ANNEE_ID - 1 AND cpg2.FORMULAIRE_ID = cpg.FORMULAIRE_ID ) as CORRESPONDANTN1_SGID, ( SELECT pu.NOM FROM PE_PAR_SUIVI_SOCIETES cpg2 LEFT JOIN PE_PAR_SOCIETE ps2 on ps2.ANNEE_ID = cpg2.ANNEE_ID and ps2.SOCIETE_SID = cpg2.SOCIETE_SID LEFT JOIN PE_DIM_UTILISATEURS pu on pu.UTILISATEUR_ID = ps2.UTILISATEUR_ID WHERE cpg2.SOCIETE_SID = cpg.SOCIETE_SID AND cpg2.ANNEE_ID = cpg.ANNEE_ID - 1 AND cpg2.FORMULAIRE_ID = cpg.FORMULAIRE_ID ) as CORRESPONDANTN1_NOM, ( SELECT pu.PRENOM FROM PE_PAR_SUIVI_SOCIETES cpg2 LEFT JOIN PE_PAR_SOCIETE ps2 on ps2.ANNEE_ID = cpg2.ANNEE_ID and ps2.SOCIETE_SID = cpg2.SOCIETE_SID LEFT JOIN PE_DIM_UTILISATEURS pu on pu.UTILISATEUR_ID = ps2.UTILISATEUR_ID WHERE cpg2.SOCIETE_SID = cpg.SOCIETE_SID AND cpg2.ANNEE_ID = cpg.ANNEE_ID - 1 AND cpg2.FORMULAIRE_ID = cpg.FORMULAIRE_ID ) as CORRESPONDANTN1_PRENOM, ( SELECT pu.EMAIL FROM PE_PAR_SUIVI_SOCIETES cpg2 LEFT JOIN PE_PAR_SOCIETE ps2 on ps2.ANNEE_ID = cpg2.ANNEE_ID and ps2.SOCIETE_SID = cpg2.SOCIETE_SID LEFT JOIN PE_DIM_UTILISATEURS pu on pu.UTILISATEUR_ID = ps2.UTILISATEUR_ID WHERE cpg2.SOCIETE_SID = cpg.SOCIETE_SID AND cpg2.ANNEE_ID = cpg.ANNEE_ID - 1 AND cpg2.FORMULAIRE_ID = cpg.FORMULAIRE_ID ) as CORRESPONDANTN1_EMAIL, ( SELECT pu.TELEPHONE FROM PE_PAR_SUIVI_SOCIETES cpg2 LEFT JOIN PE_PAR_SOCIETE ps2 on ps2.ANNEE_ID = cpg2.ANNEE_ID and ps2.SOCIETE_SID = cpg2.SOCIETE_SID LEFT JOIN PE_DIM_UTILISATEURS pu on pu.UTILISATEUR_ID = ps2.UTILISATEUR_ID WHERE cpg2.SOCIETE_SID = cpg.SOCIETE_SID AND cpg2.ANNEE_ID = cpg.ANNEE_ID - 1 AND cpg2.FORMULAIRE_ID = cpg.FORMULAIRE_ID ) as CORRESPONDANTN1_TELEPHONE FROM PE_PAR_SUIVI_SOCIETES cpg LEFT JOIN PE_DIM_SOCIETE s on s.SOCIETE_SID = cpg.SOCIETE_SID LEFT JOIN PE_DIM_ANNEE a on a.ANNEE_ID = cpg.ANNEE_ID LEFT JOIN PE_REF_STATUT_FORMULAIRE st on st.STATUT_ID = cpg.STATUT_ID LEFT JOIN PE_REF_FORMULAIRE f on f.FORMULAIRE_ID = cpg.FORMULAIRE_ID LEFT JOIN PE_PAR_SOCIETE ps on ps.ANNEE_ID = cpg.ANNEE_ID and ps.SOCIETE_SID = cpg.SOCIETE_SID LEFT JOIN PE_PAR_SUIVI_UTILISATEURS cpgu on cpgu.ANNEE_ID = cpg.ANNEE_ID and cpgu.FORMULAIRE_ID = cpg.FORMULAIRE_ID and cpgu.UTILISATEUR_ID = ps.UTILISATEUR_ID LEFT JOIN PE_DIM_UTILISATEURS cu on cu.UTILISATEUR_ID = ps.UTILISATEUR_ID  
            viewName: V_CAMPAIGN
  - changeSet:
      id: createSequence-users
      author: R1304520
      changes:
        - createSequence:
            incrementBy: 1
            maxValue: 1000000000
            minValue: 1
            ordered: true
            sequenceName: S_1_PE_DIM_UTILISATEURS
            startValue: 160
            cache: 20
            